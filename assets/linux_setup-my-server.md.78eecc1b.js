import{_ as s,o as n,c as a,a as l}from"./app.e08fe782.js";const F=JSON.parse('{"title":"规划自己的服务器","description":"","frontmatter":{},"headers":[{"level":2,"title":"设定目录","slug":"设定目录","link":"#设定目录","children":[]},{"level":2,"title":"配置Docker","slug":"配置docker","link":"#配置docker","children":[{"level":3,"title":"1.构建wordpress","slug":"_1-构建wordpress","link":"#_1-构建wordpress","children":[]},{"level":3,"title":"docker-compose","slug":"docker-compose","link":"#docker-compose","children":[]}]},{"level":2,"title":"自动获取证书","slug":"自动获取证书","link":"#自动获取证书","children":[]}],"relativePath":"linux/setup-my-server.md","lastUpdated":null}'),p={name:"linux/setup-my-server.md"},o=l(`<h1 id="规划自己的服务器" tabindex="-1">规划自己的服务器 <a class="header-anchor" href="#规划自己的服务器" aria-hidden="true">#</a></h1><h2 id="设定目录" tabindex="-1">设定目录 <a class="header-anchor" href="#设定目录" aria-hidden="true">#</a></h2><p><code>/humi-web</code></p><h2 id="配置docker" tabindex="-1">配置Docker <a class="header-anchor" href="#配置docker" aria-hidden="true">#</a></h2><h3 id="_1-构建wordpress" tabindex="-1">1.构建wordpress <a class="header-anchor" href="#_1-构建wordpress" aria-hidden="true">#</a></h3><p><code>Dockerfile</code>:</p><div class="language-docker"><button title="Copy Code" class="copy"></button><span class="lang">docker</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> wordpress</span></span>
<span class="line"><span style="color:#F78C6C;">copy</span><span style="color:#A6ACCD;"> humi-wordpress-setup.sh /</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">run</span><span style="color:#A6ACCD;"> chmod +x /humi-wordpress-setup.sh &amp;&amp; /humi-wordpress-setup.sh</span></span>
<span class="line"><span style="color:#F78C6C;">run</span><span style="color:#A6ACCD;"> a2enmod ssl</span></span>
<span class="line"><span style="color:#F78C6C;">run</span><span style="color:#A6ACCD;"> a2ensite default-ssl</span></span>
<span class="line"></span></code></pre></div><p><code>humi-wordpress-setup.sh</code>:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">#!/usr/bin/env sh</span></span>
<span class="line"><span style="color:#A6ACCD;">dm</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">example.com</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">dm_</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">example_com</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#FFCB6B;">openssl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">req</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-new</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-newkey</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rsa:</span><span style="color:#F78C6C;">2048</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-x509</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-nodes</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-days</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3650</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-out</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/ssl/certs/ssl-cert-snakeoil.pem</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-keyout</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/ssl/private/ssl-cert-snakeoil.key</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-subj</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/C=CN/ST=ShenZhen/L=ShenZhen/O=Oricur Inc./OU=Web Security/CN=</span><span style="color:#A6ACCD;">$dm</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><h3 id="docker-compose" tabindex="-1">docker-compose <a class="header-anchor" href="#docker-compose" aria-hidden="true">#</a></h3><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F07178;">version</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">3.1</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">services</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nginx</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">always</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/humi-web:/humi</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/humi-web/nginx/conf.d:/etc/nginx/conf.d</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">80:80</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">443:443</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">wordpress</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">build</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wordpress</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">always</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">WORDPRESS_DB_HOST</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wp-db</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">WORDPRESS_DB_USER</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wp</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">WORDPRESS_DB_PASSWORD</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wppw</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">WORDPRESS_DB_NAME</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wp</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wp-data:/var/www/html</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">wp-db</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mysql:5.7</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">always</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">MYSQL_DATABASE</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wp</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">MYSQL_USER</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wp</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">MYSQL_PASSWORD</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wppw</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">MYSQL_RANDOM_ROOT_PASSWORD</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wp-db:/var/lib/mysql</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">wp-data</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">wp-db</span><span style="color:#89DDFF;">:</span></span>
<span class="line"></span></code></pre></div><h2 id="自动获取证书" tabindex="-1">自动获取证书 <a class="header-anchor" href="#自动获取证书" aria-hidden="true">#</a></h2><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">acme.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--issue</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">oricur.com</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--webroot</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/humi-web/nginx/static/vitepress</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--key-file</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/humi-web/certs/root/oricur_com/key</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--fullchain-file</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/humi-web/certs/root/oricur_com/fullchain</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#C792EA;">export</span><span style="color:#A6ACCD;"> DP_Id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;&quot;</span></span>
<span class="line"><span style="color:#C792EA;">export</span><span style="color:#A6ACCD;"> DP_Key</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">acme.sh</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--issue</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--dns</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dns_dp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#C3E88D;">.oricur.com</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--key-file</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/humi-web/certs/wide/oricur_com/key</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--fullchain-file</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/humi-web/certs/wide/oricur_com/fullchain</span></span>
<span class="line"></span></code></pre></div>`,13),e=[o];function c(r,t,C,y,D,A){return n(),a("div",null,e)}const d=s(p,[["render",c]]);export{F as __pageData,d as default};
