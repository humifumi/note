import{a as d}from"./chunks/axios.c0bebe37.js";import{X as l}from"./chunks/xlsx.4d56fc9a.js";import{g as x}from"./chunks/utils.26f32e71.js";import{_ as p,o as a,c as o,b as n,t as h,f as i,w as m,v as g,d as f,e as k}from"./app.e08fe782.js";const w={data(){return{textarea_text:"",all_quests:null,current_quests:[],current_quests_translation:[],title:"提取任务列表",message:{show:!1,text:""}}},methods:{genQuestsData:function(){d.get("https://ghproxy.com/https://raw.githubusercontent.com/antest1/kcanotify-gamedata/master/files/quests-scn.json").then(e=>{this.all_quests=e.data})},processText:function(){try{this.current_quests=JSON.parse(this.textarea_text),this.getQuestsTranslation(),this.genXslx()}catch(e){this.message.show=!0,this.message.text=e}},getQuestsTranslation(){this.current_quests_translation=[],this.current_quests.forEach(e=>{this.current_quests_translation.push(this.all_quests[e.api_no])})},genXslx:function(){let e=this.current_quests_translation,t=l.utils.json_to_sheet(e);t["!cols"]=[{wch:6},{wch:30},{wch:106},{wch:7},{wch:8},{wch:48}];let u=l.utils.book_new();const _=l.utils.decode_range(t["!ref"]);_.e.c=e.length-1,t["!ref"]=l.utils.encode_range(_),l.utils.book_append_sheet(u,t,"任务列表"),l.writeFile(u,"KanColle任务列表"+x()+".xlsx")}},mounted(){console.log("ok")}},q={key:0},b={key:1},v={key:0},y={key:1},T={key:2};function N(e,t,u,_,s,c){return a(),o("div",null,[n("h2",null,h(s.title),1),s.all_quests==null?(a(),o("div",q,[n("button",{onClick:t[0]||(t[0]=(...r)=>this.genQuestsData&&this.genQuestsData(...r))},"开始")])):i("",!0),s.all_quests!=null?(a(),o("div",b,[s.textarea_text.length?(a(),o("div",v,[n("button",{onClick:t[1]||(t[1]=r=>{this.textarea_text="",this.message.text=""})},"清除输入")])):i("",!0),m(n("textarea",{rows:"10","onUpdate:modelValue":t[2]||(t[2]=r=>s.textarea_text=r),placeholder:"/kcsapi/api_get_member/questlist sv_data.api_data.api_list JSON",style:{width:"100%",border:"1px solid black"}},`
            `,512),[[g,s.textarea_text]]),s.textarea_text.length?(a(),o("div",y,[n("button",{onClick:t[3]||(t[3]=(...r)=>c.processText&&c.processText(...r))},"导出文件")])):i("",!0)])):i("",!0),s.message.show&&s.textarea_text.length?(a(),o("div",T,h(s.message.text),1)):i("",!0)])}const D=p(w,[["render",N]]),C=n("h1",{id:"任务工具",tabindex:"-1"},[k("任务工具 "),n("a",{class:"header-anchor",href:"#任务工具","aria-hidden":"true"},"#")],-1),j=JSON.parse('{"title":"任务工具","description":"","frontmatter":{},"headers":[],"relativePath":"kancolle/task-tool.md","lastUpdated":null}'),Q={name:"kancolle/task-tool.md"},B=Object.assign(Q,{setup(e){return(t,u)=>(a(),o("div",null,[C,f(D)]))}});export{j as __pageData,B as default};
